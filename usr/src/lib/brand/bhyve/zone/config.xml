<?xml version="1.0"?>

<!--
 This Source Code Form is subject to the terms of the Mozilla Public
 License, v. 2.0. If a copy of the MPL was not distributed with this
 file, You can obtain one at http://mozilla.org/MPL/2.0/.

 Copyright (c) 2018, Joyent, Inc.

 DO NOT EDIT THIS FILE.
-->

<!DOCTYPE brand PUBLIC "-//Joyent Inc//DTD Brands//EN"
    "file:///usr/share/lib/xml/dtd/brand.dtd.1">

<brand name="bhyve">
	<modname></modname>

	<initname>/usr/sbin/zhyve</initname>
	<restartinit>false</restartinit>
	<login_cmd />
	<forcedlogin_cmd />
	<user_cmd />

	<install>/usr/lib/brand/bhyve/binstall -z %z -R %R</install>
	<installopts>R:t:U:q:z:</installopts>
	<boot>/usr/lib/brand/bhyve/boot %z</boot>
	<halt />
	<verify_cfg />
	<verify_adm />
	<postclone />
	<postinstall />
	<attach>/usr/lib/brand/bhyve/attach -z %z -R %R</attach>
	<detach />
	<clone>/usr/lib/brand/bhyve/clone -z %z -R %R %Z</clone>
	<uninstall>/usr/lib/brand/bhyve/uninstall -z %z -R %R</uninstall>
	<prestatechange>/usr/lib/brand/bhyve/statechange pre %z %R</prestatechange>
	<poststatechange>/usr/lib/brand/bhyve/statechange post %z %R</poststatechange>

	<privilege set="default" name="net_rawaccess" ip-type="exclusive" />
	<privilege set="default" name="proc_clock_highres" />
	<privilege set="default" name="proc_lock_memory" />
	<privilege set="default" name="sys_admin" />
	<privilege set="default" name="sys_mount" />

	<privilege set="prohibited" name="dtrace_kernel" />
	<privilege set="prohibited" name="proc_zone" />
	<privilege set="prohibited" name="sys_config" />
	<privilege set="prohibited" name="sys_devices" />
	<privilege set="prohibited" name="sys_ip_config" ip-type="shared" />
	<privilege set="prohibited" name="sys_linkdir" />
	<privilege set="prohibited" name="sys_net_config" />
	<privilege set="prohibited" name="sys_res_config" />
	<privilege set="prohibited" name="sys_suser_compat" />
	<privilege set="prohibited" name="xvm_control" />
	<privilege set="prohibited" name="virt_manage" />
	<privilege set="prohibited" name="sys_ppp_config" ip-type="shared" />

	<privilege set="required" name="proc_exec" />
	<privilege set="required" name="sys_mount" />
</brand>
